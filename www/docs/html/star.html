<!DOCTYPE html>
<html lang="en">

<head>
  <title>...</title>

  <script>
    var isEmbedded = false; // PHP
    var isPresenting = false; // PHP
    var keystrokesMoviePrefix = null; // PHP
    var madeupPrefix = 'http://madeup.xyz'; // PHP
  </script>

  <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans|Roboto+Condensed:300|Source+Sans+Pro:300|Oswald:300|Contrail+One|News+Cycle" rel="stylesheet">
  <script src="http://madeup.xyz/repos/blockly/blockly_compressed.js"></script>
  <script src="http://madeup.xyz/repos/blockly/blocks_compressed.js"></script>
  <script src="http://madeup.xyz/repos/blockly/madeup_compressed.js"></script>
  <script src="http://madeup.xyz/repos/blockly/msg/js/en.js"></script>
  <!-- <script src="http://madeup.xyz/deps.min.js"></script> -->

  <!-- <link rel="stylesheet" href="http://code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css"> -->
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
  <script src="http://madeup.xyz/repos/ace/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
  <!-- <script src="repos/blockly/blockly_uncompressed.js"></script> -->
  <!-- <script src="repos/blockly/blocks/logic.js"></script> -->
  <!-- <script src="repos/blockly/blocks/loops.js"></script> -->
  <!-- <script src="repos/blockly/blocks/math.js"></script> -->
  <!-- <script src="repos/blockly/blocks/text.js"></script> -->
  <!-- <script src="repos/blockly/blocks/lists.js"></script> -->
  <!-- <script src="repos/blockly/blocks/colour.js"></script> -->
  <!-- <script src="repos/blockly/blocks/variables.js"></script> -->
  <!-- <script src="repos/blockly/blocks/procedures.js"></script> -->
  <!-- <script src="repos/blockly/blocks/zmadeup.js"></script> -->
  <!-- <script src="repos/blockly/generators/madeup.js"></script> -->
  <!-- <script src="repos/blockly/msg/js/en.js"></script> -->
  <script src="http://madeup.xyz/js/text_to_blocks.js"></script>

  <style>html {
  box-sizing: border-box;
  margin: 0;
}

*, *:before, *:after {
  box-sizing: inherit;
}

.indented {
  margin-left: 20px;
}

body {
  background: white;
  font-family: 'Source Sans Pro';
  color: #555555;
  margin: 10px;
}

h1 {
  color: rgb(50%, 60%, 70%);
  font-family: 'Contrail One', sans;
  font-size: 40pt;
  margin-top: 0;
  margin-bottom: 0;
  font-weight: bold;
}

h2 {
  margin-top: 5px;
  margin-bottom: 0px;
  color: rgb(65%, 75%, 85%);
  font-family: 'Oswald', sans;
  font-size: 20pt;
}

.h2link {
  text-decoration: none;
  color: rgb(55%, 65%, 75%);
}

h3 {
  font-family: 'Merriweather Sans', sans;
  font-weight: bold;
  font-size: 18pt;
  color: rgb(70%, 50%, 50%);
  margin-bottom: 0px;
}

h4 {
  font-weight: bold;
  font-size: 16pt;
  color: rgb(75%, 55%, 55%);
  margin-bottom: 2px;
  margin-top: 10px;
}

h5 {
  font-style: italic;
  font-size: 14pt;
  margin-bottom: 0px;
  color: rgb(55%, 55%, 55%);
}

h6 {
  font-weight: bold;
  font-size: 12pt;
  color: rgb(75%, 55%, 55%);
}

a {
  text-decoration: none;
  font-weight: bold;
  color: #483d8b;
}

pre {
  box-shadow: 0 1px 0 #ffffff, inset 0 1px 1px rgba(0, 0, 0, 0.2);
  box-sizing: border-box;
  background: #f4f4f4;
  border: 1px solid #aaaaaa;
  border-bottom-color: #cccccc;
  border-radius: 2px;
  height: auto;
  margin: 10px 0px;
  outline: none;
  padding: 6px 10px;
  vertical-align: middle;
  width: 100%;
  overflow: auto;
}

.graycentered {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.graysignature {
  display: block;
  margin-left: 400px;
}

.graysignature > * {
  display: block;
  margin-top: 5px;
  margin-bottom: 5px;
}

code {
  white-space: pre;
  background-color: #f7f7f9;
  padding: 2px 4px;
  border: 1px solid #e1e1e8;
  border-radius: 3px;
  color: #d14;
}

figure {
  margin: 0px 0px;
}

figcaption {
  display: block;
  font-style: italic;
  font-size: small;
}

figure br {
  display: none;
}

.grayblock {
  margin-top: 15px;
  margin-bottom: 15px;
}

/* Superseded by .grayblock. */
p {
  margin-top: 3px;
  margin-bottom: 10px;
}

.madeup-frame {
  /* border: solid 1px black; */
  border: none;
  width: 100%;
}

.gray-wrap {
  white-space: pre-wrap;
}

td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
body .hll { background-color: #ffffcc }
body .c { color: #888888 } /* Comment */
body .err { color: #FF0000; background-color: #FFAAAA } /* Error */
body .k { color: #008800; font-weight: bold } /* Keyword */
body .o { color: #333333 } /* Operator */
body .ch { color: #888888 } /* Comment.Hashbang */
body .cm { color: #888888 } /* Comment.Multiline */
body .cp { color: #557799 } /* Comment.Preproc */
body .cpf { color: #888888 } /* Comment.PreprocFile */
body .c1 { color: #888888 } /* Comment.Single */
body .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
body .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #333399; font-weight: bold } /* Keyword.Type */
body .m { color: #6600EE; font-weight: bold } /* Literal.Number */
body .s { background-color: #fff0f0 } /* Literal.String */
body .na { color: #0000CC } /* Name.Attribute */
body .nb { color: #007020 } /* Name.Builtin */
body .nc { color: #BB0066; font-weight: bold } /* Name.Class */
body .no { color: #003366; font-weight: bold } /* Name.Constant */
body .nd { color: #555555; font-weight: bold } /* Name.Decorator */
body .ni { color: #880000; font-weight: bold } /* Name.Entity */
body .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
body .nf { color: #0066BB; font-weight: bold } /* Name.Function */
body .nl { color: #997700; font-weight: bold } /* Name.Label */
body .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
body .nt { color: #007700 } /* Name.Tag */
body .nv { color: #996633 } /* Name.Variable */
body .ow { color: #000000; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
body .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
body .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
body .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
body .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
body .sa { background-color: #fff0f0 } /* Literal.String.Affix */
body .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
body .sc { color: #0044DD } /* Literal.String.Char */
body .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
body .sd { color: #DD4422 } /* Literal.String.Doc */
body .s2 { background-color: #fff0f0 } /* Literal.String.Double */
body .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
body .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
body .si { background-color: #eeeeee } /* Literal.String.Interpol */
body .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
body .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
body .s1 { background-color: #fff0f0 } /* Literal.String.Single */
body .ss { color: #AA6600 } /* Literal.String.Symbol */
body .bp { color: #007020 } /* Name.Builtin.Pseudo */
body .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
body .vc { color: #336699 } /* Name.Variable.Class */
body .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
body .vi { color: #3333BB } /* Name.Variable.Instance */
body .vm { color: #996633 } /* Name.Variable.Magic */
body .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */

.text-editor {
  display: block;
}

.block-editor {
  margin: auto;
}

.blocklySvg {
  background-color: rgba(0, 0, 0, 0) !important;
}

.blocklyMainBackground {
  stroke: none !important;
}

.s-expression {
  display: none;
}

#mode-switcher {
  text-align: right;
}

footer {
  text-align: right;
}


/* Custom CSS */
</style>
  <script>function autosize(id) {
  var element = document.getElementById(id);
  element.width = element.contentWindow.document.body.clientWidth;
  element.height = element.contentWindow.document.body.clientHeight;
}

function lineveil() {
  var tag = $(this).next();
  if (tag.css('display') == 'none') {
    tag.next().fadeOut(400, function() {
      tag.fadeIn(400);
    });
  } else {
    tag.fadeOut(400, function() {
      tag.next().fadeIn();
    });
  }

  // Window scrolls up without this if called by anchor!
  return false;
}

function listveilShow(hider) {
  $(hider).fadeOut(400, function() {
    $(hider).next().fadeIn();
  });
  return false;
}

$(document).ready(function() {
  $('span.lineveil').css('display', 'none');
  $('span.lineveil').after('<span>...</span>');
  $('a.lineveil').click(lineveil);
  $('.listveil * li').wrapInner('<span class="listveil"></span>');
  $('span.listveil').hide().before('<a href="#" onclick="listveilShow(this); return false;">...</a>');
});

function shuffle(list) {
  for (var i = list.length - 1; i > 0; i -= 1) {
    var j = Math.floor(Math.random() * (i + 1));
    var tmp = list[i];
    list[i] = list[j];
    list[j] = tmp;
  }
}

function scramble(list) {
  for (var i = list.children.length; i >= 0; --i) {
    list.appendChild(list.children[Math.random() * i | 0]);
  }
}

$(function() {
  $('.scrambled').sortable();
  $('.scrambled').disableSelection();
  $('.scrambled').each(function() {
    scramble(this);
  });

  $('.scramble').click(function() {
    scramble($(this).parent().prev()[0]);
  });
});

$(function() {
  $('.togglee').css('display', 'none');
  $('.toggler').click(function() {
    if ($(this).next().css('display') == 'none') {
      $(this).next().slideDown();
    } else {
      $(this).next().slideUp();
    }
    return false;
  });
});

function getTimeString(nseconds, nseconds_max) {
  var minutes = Math.floor(nseconds / 60);
  var minutes_max = Math.floor(nseconds_max / 60);
  var seconds = nseconds % 60;

  var s = '';
  
  var diff = ('' + minutes_max).length - ('' + minutes).length;
  for (var i = 0; i < diff; ++i) {
    s += '&nbsp;';
  }

  s += minutes + ':'
  if (nseconds % 60 < 10) {
    s += "0";
  }
  s += nseconds % 60;

  return s;
}

function updateTimedown(id, nseconds, nseconds_max) {
  document.getElementById(id).innerHTML = getTimeString(nseconds, nseconds_max);
  nseconds -= 1;
  if (nseconds >= 0) {
    timers[id] = setTimeout("updateTimedown('" + id + "', " + nseconds + ", " + nseconds_max + ")", 1000);
  } else {
    document.getElementById(id).innerHTML = 'Time\'s up!';
  }
}

function onTimedownClick(id, nseconds) {
  if (timers[id] == undefined) {
    updateTimedown(id, nseconds, nseconds);
  } else {
    clearTimeout(timers[id]);
    timers[id] = undefined;
  }
}

function generateTimedown(nseconds, id) {
  document.write('<div id="' + id + '" align="center" style="font-family: monospace; font-size: xx-large; padding: 0.5em;" onClick="onTimedownClick(\'' + id + '\', ' + nseconds + ')">' + getTimeString(nseconds, nseconds) + '</div>');
}

var timers = {};

function raffle(element, list) {
  if (list.length == 0) {
    element.innerHTML = '&iexcl;no mas!';
  } else {
    element.innerHTML = list[list.length - 1];
    list.splice(list.length - 1);
  }
}

document.addEventListener('DOMContentLoaded', function() {

  // Inject Ace editors on all the code snippets.
  var editors = document.querySelectorAll('.text-editor');
  editors.forEach(function(editor) {
    var editor = ace.edit(editor);
    editor.$blockScrolling = Infinity;
    editor.renderer.$cursorLayer.element.style.display = "none";
    editor.setTheme("ace/theme/iplastic");
    editor.getSession().setMode("ace/mode/madeup");
    editor.setOptions({
      maxLines: 15,
      showPrintMargin: false,
      highlightActiveLine: false,
      highlightGutterLine: false,
      readOnly: true,
      fontSize: 16
    });
    editor.renderer.setScrollMargin(10, 10);
  });

  // Inject Blockly workspaces on all the code snippets.
  var switchers = document.querySelectorAll('.mup-switcher');
  var workspaces = [];
  switchers.forEach(function(switcher) {
    var textEditor = switcher.children[0];
    var blocksEditor = switcher.children[1];

    var workspace = Blockly.inject(blocksEditor, {
      comments: false,
      toolbox: false,
      trashcan: false,
      readOnly: true,
      scrollbars: false,
      zoom: false
    });

    // Fit the container exactly around the blocks.
    var sExpression = blocksEditor.firstElementChild.innerHTML;
    parse(new Peeker(sExpression), workspace);
    var metrics = workspace.getMetrics();
    blocksEditor.style.height = metrics.contentHeight + 'px';
    blocksEditor.style.width = metrics.contentWidth + 'px';
    Blockly.svgResize(workspace);

    blocksEditor.style.display = 'none';

    workspaces.push(workspace);
  });

  document.getElementById('to-text').onclick = function() {
    var switchers = document.querySelectorAll('.mup-switcher');
    switchers.forEach(function(switcher) {
      var textEditor = switcher.children[0];
      var blocksEditor = switcher.children[1];
      textEditor.style.display = 'block';
      blocksEditor.style.display = 'none';
    });
    return false;
  };

  document.getElementById('to-blocks').onclick = function() {
    var switchers = document.querySelectorAll('.mup-switcher');
    switchers.forEach(function(switcher) {
      var textEditor = switcher.children[0];
      var blocksEditor= switcher.children[1];
      textEditor.style.display = 'none';
      blocksEditor.style.display = 'block';
      workspaces.forEach(function(workspace) {
        Blockly.svgResize(workspace);
      });
    });
    return false;
  };
});

// window.addEventListener('resize', function() {
  // workspaces.forEach(function(workspace) {
    // console.log("resize");
    // Blockly.svgResize(workspace);
  // });
// });
</script>
</head>

<body>
  <header id="mode-switcher">
    <a href="#" class="to-mode" id="to-text">text</a> |
    <a href="#" class="to-mode" id="to-blocks">blocks</a>
  </header>



<h3>Star</h3>

<p class="grayblock">In this lesson, we'll walk a star-shaped path and extend it into the scene with the <code>extrude</code> solidifier.</p>

<p class="grayblock">Before jumping into code, do the following to get a feel for our task:</p>

<ol>
  <li>Draw the outline of a five-pointed star on a piece of paper.</li>
  <li>Put your finger on one of the inner corners or vertices.</li>
  <li>Imagine you are sitting in a car (or on a bicycle) at that vertex.</li>
  <li>Start driving along the edge. What can you say about the turns you are making?</li>
</ol>

<p class="grayblock">You should see that driving around a star is a little like driving around a circle. What's different is that on some steps we turn left, while on others we turn right. This alternation creates the five pointed arms.</p>

<p class="grayblock">Let's recreate that driving experience in Madeup. We start by positioning ourselves at the origin and walking up the first arm:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

move 10</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (call move (INTEGER 10)))
</div></div>
</div>
</p>

<p class="grayblock">Let's take a right and walk the other side of the arm. But how many degrees should we turn? There's not one right answer here. Let's use 122 for the time being:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

move 10
yaw 122
move 10</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (call move (INTEGER 10)) (call yaw (INTEGER 122)) (call move (INTEGER 10)))
</div></div>
</div>
</p>

<p class="grayblock">At this point we are almost ready to walk the next arm. But we need to do something first. What is that something?</p>

<p class="grayblock">We need to turn left to get pointed along the next arm. But by how much?</p>

<p class="grayblock">We know that we'll need to travel a full 360 degrees to get back where we started, and we have five arms to do it in. That means each arm will have to effectively turn 360 / 5 = 72 degrees. We've already turned 122 degrees. 122 plus what is 72?</p>

<p class="grayblock">Exactly. We must turn -50 degrees:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

move 10
yaw 122
move 10
yaw -50</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (call move (INTEGER 10)) (call yaw (INTEGER 122)) (call move (INTEGER 10)) (call yaw (INTEGER -50)))
</div></div>
</div>
</p>

<p class="grayblock">To get the next arm, we could copy and paste. But that would be silly. This is a job for <code>repeat</code>:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

repeat 1
  move 10
  yaw 122
  move 10
  yaw -50
end</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (repeat (INTEGER 1) (block (call move (INTEGER 10)) (call yaw (INTEGER 122)) (call move (INTEGER 10)) (call yaw (INTEGER -50)))))
</div></div>
</div>
</p>

<p class="grayblock">Increase the repeat count to 2 to see the next arm. Then 3. Then 4. And finally 5. I always recommend testing loops incrementally like this. If you jump straight to 5, it's hard to reason about what the loop is doing.</p>

<p class="grayblock">Now we're ready to solidify this. You could use <code>dowel</code> to make a cookie cutter. But let's check out the <code>extrude</code> solidifier, which interprets our path as the cross section of solid shape and extends it along some direction. Let's extend it along the Z axis, which is (0, 0, 1). We also need to tell <code>extrude</code> how far to extend the cross section. Let's go with 6:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

repeat 5
  move 10
  yaw 122
  move 10
  yaw -50
end

extrude 0, 0, 1, 6</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (repeat (INTEGER 5) (block (call move (INTEGER 10)) (call yaw (INTEGER 122)) (call move (INTEGER 10)) (call yaw (INTEGER -50)))) (call extrude (INTEGER 0) (INTEGER 0) (INTEGER 1) (INTEGER 6)))
</div></div>
</div>
</p>

<p class="grayblock">How's that? Try tweaking the degrees you turn to change the pointiness of the star.</p>

<p class="grayblock">If you change one of the turn numbers, you also have to change the other because the two turns must add up to 72. In general, we can say that <code>rightTurn + leftTurn = 72</code>. Given this mandatory relationship, wouldn't it be nice if we could just pick the right turn amount and have the left turn automatically calculated? We can do this using a <em>variable</em>.</p>

<p class="grayblock">We start by creating a variable for the right turn amount. We'll call it <code>angle</code>. We assignment <code>angle</code> the value 144, and then we turn by <code>angle</code> instead of 122:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

angle = 144
repeat 5
  move 10
  yaw angle
  move 10
  yaw -50
end

extrude 0, 0, 1, 6</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (define-variable angle (INTEGER 144)) (repeat (INTEGER 5) (block (call move (INTEGER 10)) (call yaw (call-with-names angle)) (call move (INTEGER 10)) (call yaw (INTEGER -50)))) (call extrude (INTEGER 0) (INTEGER 0) (INTEGER 1) (INTEGER 6)))
</div></div>
</div>
</p>

<p class="grayblock">Then we calculate the left turn with a little arithmetic:</p>

<p class="grayblock"><div class="mup-switcher">
  <div class="text-editor">moveto 0, 0, 0

angle = 144
repeat 5
  move 10
  yaw angle
  move 10
  yaw 72 - angle
end

extrude 0, 0, 1, 6</div>
  <div class="block-editor"><div class="s-expression">(block (call moveto (INTEGER 0) (INTEGER 0) (INTEGER 0)) (define-variable angle (INTEGER 144)) (repeat (INTEGER 5) (block (call move (INTEGER 10)) (call yaw (call-with-names angle)) (call move (INTEGER 10)) (call yaw (- (INTEGER 72) (call-with-names angle))))) (call extrude (INTEGER 0) (INTEGER 0) (INTEGER 1) (INTEGER 6)))
</div></div>
</div>
</p>

<p class="grayblock">Now if we change <code>angle</code>, the left turn will be computed automatically to ensure that a star is born.</p>
  <footer><a id="home" href="index.html">Home</a></footer>
</body>
</html>
